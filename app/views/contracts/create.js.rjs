unless @contract.valid?
  page.replace_html :create_contract, :partial => "form"
else
  if @callback
    page << %Q{
      window.opener.#{@callback}('#{@contract.contract_id}')
    }
  end
  page << %Q{
    window.opener = null;
    window.open('', '_self');
    window.close();
  }
end
